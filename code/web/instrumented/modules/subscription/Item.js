var cov_4ncasqibp = function () {
  var path = "/Users/abhijeet.daspatnaik/Documents/projects/crate-abhidp/code/web/src/modules/subscription/Item.js";
  var hash = "c48eaca693d33930219d492d50b32b3861e26c38";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/abhijeet.daspatnaik/Documents/projects/crate-abhidp/code/web/src/modules/subscription/Item.js",
    statementMap: {
      "0": {
        start: {
          line: 23,
          column: 4
        },
        end: {
          line: 23,
          column: 16
        }
      },
      "1": {
        start: {
          line: 25,
          column: 4
        },
        end: {
          line: 27,
          column: 5
        }
      },
      "2": {
        start: {
          line: 30,
          column: 23
        },
        end: {
          line: 63,
          column: 3
        }
      },
      "3": {
        start: {
          line: 31,
          column: 16
        },
        end: {
          line: 31,
          column: 78
        }
      },
      "4": {
        start: {
          line: 33,
          column: 4
        },
        end: {
          line: 62,
          column: 5
        }
      },
      "5": {
        start: {
          line: 34,
          column: 6
        },
        end: {
          line: 36,
          column: 8
        }
      },
      "6": {
        start: {
          line: 38,
          column: 6
        },
        end: {
          line: 38,
          column: 59
        }
      },
      "7": {
        start: {
          line: 40,
          column: 6
        },
        end: {
          line: 61,
          column: 10
        }
      },
      "8": {
        start: {
          line: 42,
          column: 10
        },
        end: {
          line: 48,
          column: 11
        }
      },
      "9": {
        start: {
          line: 43,
          column: 12
        },
        end: {
          line: 43,
          column: 67
        }
      },
      "10": {
        start: {
          line: 45,
          column: 12
        },
        end: {
          line: 45,
          column: 64
        }
      },
      "11": {
        start: {
          line: 47,
          column: 12
        },
        end: {
          line: 47,
          column: 38
        }
      },
      "12": {
        start: {
          line: 51,
          column: 10
        },
        end: {
          line: 51,
          column: 101
        }
      },
      "13": {
        start: {
          line: 54,
          column: 10
        },
        end: {
          line: 56,
          column: 12
        }
      },
      "14": {
        start: {
          line: 58,
          column: 10
        },
        end: {
          line: 60,
          column: 18
        }
      },
      "15": {
        start: {
          line: 59,
          column: 12
        },
        end: {
          line: 59,
          column: 36
        }
      },
      "16": {
        start: {
          line: 66,
          column: 37
        },
        end: {
          line: 66,
          column: 60
        }
      },
      "17": {
        start: {
          line: 67,
          column: 26
        },
        end: {
          line: 67,
          column: 36
        }
      },
      "18": {
        start: {
          line: 69,
          column: 4
        },
        end: {
          line: 96,
          column: 5
        }
      },
      "19": {
        start: {
          line: 101,
          column: 0
        },
        end: {
          line: 108,
          column: 1
        }
      },
      "20": {
        start: {
          line: 112,
          column: 2
        },
        end: {
          line: 114,
          column: 3
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 22,
            column: 2
          },
          end: {
            line: 22,
            column: 3
          }
        },
        loc: {
          start: {
            line: 22,
            column: 21
          },
          end: {
            line: 28,
            column: 3
          }
        },
        line: 22
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 30,
            column: 23
          },
          end: {
            line: 30,
            column: 24
          }
        },
        loc: {
          start: {
            line: 30,
            column: 31
          },
          end: {
            line: 63,
            column: 3
          }
        },
        line: 30
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 41,
            column: 14
          },
          end: {
            line: 41,
            column: 15
          }
        },
        loc: {
          start: {
            line: 41,
            column: 26
          },
          end: {
            line: 49,
            column: 9
          }
        },
        line: 41
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 50,
            column: 15
          },
          end: {
            line: 50,
            column: 16
          }
        },
        loc: {
          start: {
            line: 50,
            column: 24
          },
          end: {
            line: 52,
            column: 9
          }
        },
        line: 50
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 53,
            column: 14
          },
          end: {
            line: 53,
            column: 15
          }
        },
        loc: {
          start: {
            line: 53,
            column: 20
          },
          end: {
            line: 61,
            column: 9
          }
        },
        line: 53
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 58,
            column: 28
          },
          end: {
            line: 58,
            column: 29
          }
        },
        loc: {
          start: {
            line: 58,
            column: 34
          },
          end: {
            line: 60,
            column: 11
          }
        },
        line: 58
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 65,
            column: 2
          },
          end: {
            line: 65,
            column: 3
          }
        },
        loc: {
          start: {
            line: 65,
            column: 11
          },
          end: {
            line: 97,
            column: 3
          }
        },
        line: 65
      },
      "7": {
        name: "itemState",
        decl: {
          start: {
            line: 111,
            column: 9
          },
          end: {
            line: 111,
            column: 18
          }
        },
        loc: {
          start: {
            line: 111,
            column: 26
          },
          end: {
            line: 115,
            column: 1
          }
        },
        line: 111
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 33,
            column: 4
          },
          end: {
            line: 62,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 33,
            column: 4
          },
          end: {
            line: 62,
            column: 5
          }
        }, {
          start: {
            line: 33,
            column: 4
          },
          end: {
            line: 62,
            column: 5
          }
        }],
        line: 33
      },
      "1": {
        loc: {
          start: {
            line: 42,
            column: 10
          },
          end: {
            line: 48,
            column: 11
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 42,
            column: 10
          },
          end: {
            line: 48,
            column: 11
          }
        }, {
          start: {
            line: 42,
            column: 10
          },
          end: {
            line: 48,
            column: 11
          }
        }],
        line: 42
      },
      "2": {
        loc: {
          start: {
            line: 42,
            column: 14
          },
          end: {
            line: 42,
            column: 69
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 42,
            column: 14
          },
          end: {
            line: 42,
            column: 34
          }
        }, {
          start: {
            line: 42,
            column: 38
          },
          end: {
            line: 42,
            column: 69
          }
        }],
        line: 42
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0]
    },
    _coverageSchema: "43e27e138ebf9cfc5966b082cf9a028302ed4184",
    hash: "c48eaca693d33930219d492d50b32b3861e26c38"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  return coverage[path] = coverageData;
}();

// Imports
import React, { PureComponent } from 'react';
import PropTypes from 'prop-types';
import { connect } from 'react-redux';
import { withRouter } from 'react-router-dom'; // UI Imports

import Card from '../../ui/card/Card';
import Button from '../../ui/button/Button';
import H4 from '../../ui/typography/H4';
import Icon from '../../ui/icon';
import { white, grey2, black } from '../../ui/common/colors'; // App Imports

import { APP_URL } from '../../setup/config/env';
import { messageShow, messageHide } from '../common/api/actions';
import { remove, getListByUser } from '../subscription/api/actions'; // Component

class Item extends PureComponent {
  constructor(props) {
    cov_4ncasqibp.f[0]++;
    cov_4ncasqibp.s[0]++;
    super(props);
    cov_4ncasqibp.s[1]++;
    this.state = {
      isLoading: false
    };
  }

  onClickUnsubscribe = (cov_4ncasqibp.s[2]++, id => {
    cov_4ncasqibp.f[1]++;
    let check = (cov_4ncasqibp.s[3]++, confirm('Are you sure you want to unsubscribe to this crate?'));
    cov_4ncasqibp.s[4]++;

    if (check) {
      cov_4ncasqibp.b[0][0]++;
      cov_4ncasqibp.s[5]++;
      this.setState({
        isLoading: true
      });
      cov_4ncasqibp.s[6]++;
      this.props.messageShow('Subscribing, please wait...');
      cov_4ncasqibp.s[7]++;
      this.props.remove({
        id
      }).then(response => {
        cov_4ncasqibp.f[2]++;
        cov_4ncasqibp.s[8]++;

        if ((cov_4ncasqibp.b[2][0]++, response.data.errors) && (cov_4ncasqibp.b[2][1]++, response.data.errors.length > 0)) {
          cov_4ncasqibp.b[1][0]++;
          cov_4ncasqibp.s[9]++;
          this.props.messageShow(response.data.errors[0].message);
        } else {
          cov_4ncasqibp.b[1][1]++;
          cov_4ncasqibp.s[10]++;
          this.props.messageShow('Unsubscribed successfully.');
          cov_4ncasqibp.s[11]++;
          this.props.getListByUser();
        }
      }).catch(error => {
        cov_4ncasqibp.f[3]++;
        cov_4ncasqibp.s[12]++;
        this.props.messageShow('There was some error subscribing to this crate. Please try again.');
      }).then(() => {
        cov_4ncasqibp.f[4]++;
        cov_4ncasqibp.s[13]++;
        this.setState({
          isLoading: false
        });
        cov_4ncasqibp.s[14]++;
        window.setTimeout(() => {
          cov_4ncasqibp.f[5]++;
          cov_4ncasqibp.s[15]++;
          this.props.messageHide();
        }, 5000);
      });
    } else {
      cov_4ncasqibp.b[0][1]++;
    }
  });

  render() {
    cov_4ncasqibp.f[6]++;
    const {
      id,
      crate,
      createdAt
    } = (cov_4ncasqibp.s[16]++, this.props.subscription);
    const {
      isLoading
    } = (cov_4ncasqibp.s[17]++, this.state);
    cov_4ncasqibp.s[18]++;
    return <Card style={{
      width: '18em',
      backgroundColor: white
    }}>
        <p style={{
        padding: '2em 3em 0 3em'
      }}>
          <img src={`${APP_URL}/images/crate.png`} alt={crate.name} style={{
          width: '100%'
        }} />
        </p>

        <div style={{
        padding: '1em 1.2em'
      }}>
          <H4 font="secondary" style={{
          color: black
        }}>{crate.name}</H4>

          <p style={{
          color: grey2,
          marginTop: '1em'
        }}>{crate.description}</p>

          <p style={{
          textAlign: 'center',
          marginTop: '1.5em',
          marginBottom: '1em'
        }}>
            <Button theme="secondary" onClick={this.onClickUnsubscribe.bind(this, id)} type="button" disabled={isLoading}>
              <Icon size={1.2} style={{
              color: white
            }}>remove_circle_outline</Icon> Unsubscribe
            </Button>
          </p>

          <p style={{
          color: grey2,
          marginTop: '1em',
          fontSize: '0.8em',
          textAlign: 'center'
        }}>
            Subscribed on {new Date(parseInt(createdAt)).toDateString()}
          </p>
        </div>
      </Card>;
  }

} // Component Properties


cov_4ncasqibp.s[19]++;
Item.propTypes = {
  subscription: PropTypes.object.isRequired,
  user: PropTypes.object.isRequired,
  remove: PropTypes.func.isRequired,
  getListByUser: PropTypes.func.isRequired,
  messageShow: PropTypes.func.isRequired,
  messageHide: PropTypes.func.isRequired
}; // Component State

function itemState(state) {
  cov_4ncasqibp.f[7]++;
  cov_4ncasqibp.s[20]++;
  return {
    user: state.user
  };
}

export default connect(itemState, {
  remove,
  getListByUser,
  messageShow,
  messageHide
})(withRouter(Item));